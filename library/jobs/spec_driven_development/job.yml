name: spec_driven_development
version: "1.0.0"
summary: "Spec-driven development workflow that turns specifications into working implementations through structured planning."
description: |
  A comprehensive workflow inspired by GitHub's spec-kit that enables "spec-driven development" -
  a methodology where executable specifications generate working implementations rather than
  merely guiding them.

  This job inverts traditional development: instead of starting with code, you first create
  detailed specifications that directly generate implementations. The workflow progresses through
  six phases:

  1. **Constitution**: Establish project governance principles and development guidelines
  2. **Specification**: Define functional requirements focusing on "what" and "why"
  3. **Clarification**: Resolve ambiguities before technical planning
  4. **Planning**: Create technical implementation strategy and architecture
  5. **Task Generation**: Break plans into actionable, ordered development tasks
  6. **Implementation**: Execute tasks to deliver the complete feature

  The workflow produces all artifacts in a `specs/[feature-name]/` directory structure,
  keeping specifications versioned alongside the implementation they generate.

  Ideal for:
  - New feature development requiring upfront design
  - Complex features with multiple stakeholders
  - Projects where specification quality directly impacts implementation success
  - Teams wanting to capture design decisions for future reference

changelog:
  - version: "1.0.0"
    changes: "Initial version based on GitHub spec-kit workflow"

steps:
  - id: constitution
    name: "Establish Constitution"
    hidden: true
    description: "Creates foundational governance principles and development guidelines for the project. Use when starting a new project or establishing standards."
    instructions_file: steps/constitution.md
    inputs:
      - name: development_priorities
        description: "Key priorities like code quality, testing, UX consistency, performance"
    outputs:
      - file: "[docs_folder]/constitution.md"
    dependencies: []
    quality_criteria:
      - "**Priorities Captured**: Did the agent gather specific development priorities from the user?"
      - "**Principles Defined**: Are governance principles clear and actionable?"
      - "**Technology Guidance**: Does the constitution include relevant technology stack preferences?"
      - "**Quality Standards**: Are quality standards and testing expectations defined?"
      - "**File Created**: Has constitution.md been created in the project's documentation folder?"

  - id: specify
    name: "Create Specification"
    hidden: true
    description: "Defines functional requirements as user stories without technology choices. Use when starting to design a new feature."
    instructions_file: steps/specify.md
    inputs:
      - name: feature_name
        description: "Name of the feature being specified (lowercase, hyphens for spaces)"
      - name: feature_description
        description: "High-level description of what the feature should do"
      - file: "[docs_folder]/constitution.md"
        from_step: constitution
    outputs:
      - file: specs/[feature-name]/spec.md
    dependencies:
      - constitution
    quality_criteria:
      - "**User Stories Complete**: Are all user stories written in standard format (As a... I want... So that...)?"
      - "**Acceptance Criteria**: Does each story have clear, testable acceptance criteria?"
      - "**Non-Functional Requirements**: Are performance, security, and accessibility requirements captured?"
      - "**Scope Boundaries**: Is it clear what's in and out of scope?"
      - "**Constitution Aligned**: Does the spec respect the governance principles from the constitution?"
      - "**Technology Agnostic**: Is the spec free of implementation details and technology choices?"
      - "**File Created**: Has spec.md been created in `specs/[feature-name]/`?"

  - id: clarify
    name: "Clarify Specification"
    hidden: true
    description: "Resolves ambiguities and gaps in the specification through structured questioning. Use after specification to ensure completeness."
    instructions_file: steps/clarify.md
    inputs:
      - file: specs/[feature-name]/spec.md
        from_step: specify
    outputs:
      - file: specs/[feature-name]/spec.md
    dependencies:
      - specify
    quality_criteria:
      - "**Ambiguities Identified**: Were underspecified areas systematically identified?"
      - "**Questions Asked**: Did the agent ask structured questions to resolve each ambiguity?"
      - "**Answers Documented**: Are clarification answers recorded in the spec document?"
      - "**Edge Cases Covered**: Are edge cases and error scenarios now defined?"
      - "**Acceptance Checklist**: Is the acceptance criteria checklist complete and validated?"
      - "**Spec Updated**: Has spec.md been updated with all clarifications?"

  - id: plan
    name: "Generate Technical Plan"
    hidden: true
    description: "Creates technical implementation strategy including architecture and technology choices. Use after specification is clarified."
    instructions_file: steps/plan.md
    inputs:
      - file: specs/[feature-name]/spec.md
        from_step: clarify
      - file: "[docs_folder]/constitution.md"
        from_step: constitution
      - file: "[docs_folder]/architecture.md"
        description: "Existing project architecture document (if present)"
    outputs:
      - file: specs/[feature-name]/plan.md
      - file: specs/[feature-name]/data-model.md
      - file: specs/[feature-name]/api-spec.json
      - file: specs/[feature-name]/research.md
      - file: "[docs_folder]/architecture.md"
        description: "Updated project architecture document"
    dependencies:
      - clarify
    quality_criteria:
      - "**Architecture Defined**: Is the high-level architecture clearly described?"
      - "**Technology Justified**: Are technology choices explained with rationale?"
      - "**Data Model Complete**: Is the data model documented with all entities and relationships?"
      - "**API Contracts**: Are API endpoints defined with request/response schemas?"
      - "**Research Documented**: Are any research findings or technology evaluations captured?"
      - "**Dependencies Listed**: Are external dependencies and their versions specified?"
      - "**Constitution Respected**: Does the plan align with governance principles?"
      - "**Architecture Doc Updated**: Has the project architecture document been reviewed and updated if needed?"
      - "**Files Created**: Have all output files been created in `specs/[feature-name]/`?"

  - id: tasks
    name: "Generate Task Breakdown"
    hidden: true
    description: "Converts the implementation plan into actionable, ordered development tasks. Use after plan is validated."
    instructions_file: steps/tasks.md
    inputs:
      - file: specs/[feature-name]/plan.md
        from_step: plan
      - file: specs/[feature-name]/spec.md
        from_step: clarify
      - file: "[docs_folder]/architecture.md"
        from_step: plan
    outputs:
      - file: specs/[feature-name]/tasks.md
    dependencies:
      - plan
    quality_criteria:
      - "**User Story Organization**: Are tasks organized by user story?"
      - "**Dependencies Sequenced**: Are task dependencies correctly ordered?"
      - "**Parallel Tasks Marked**: Are parallelizable tasks identified with [P] markers?"
      - "**File Paths Specified**: Does each task specify which files it creates/modifies?"
      - "**TDD Structure**: Are test tasks included before or alongside implementation tasks?"
      - "**Checkpoints Defined**: Are validation checkpoints included between phases?"
      - "**Granularity Appropriate**: Are tasks small enough to be completed in one session?"
      - "**File Created**: Has tasks.md been created in `specs/[feature-name]/`?"

  - id: implement
    name: "Execute Implementation"
    hidden: true
    description: "Generates code and assets by executing the task breakdown. Use when ready to build the feature."
    instructions_file: steps/implement.md
    inputs:
      - file: specs/[feature-name]/tasks.md
        from_step: tasks
      - file: specs/[feature-name]/plan.md
        from_step: plan
      - file: specs/[feature-name]/spec.md
        from_step: clarify
      - file: "[docs_folder]/architecture.md"
        from_step: plan
    outputs:
      - directory: src/
        description: "Implementation source files as specified in tasks"
      - directory: tests/
        description: "Test files as specified in tasks"
    dependencies:
      - tasks
    quality_criteria:
      - "**Prerequisites Met**: Were all spec/plan/tasks artifacts validated before starting?"
      - "**Task Order Followed**: Were tasks executed in dependency order?"
      - "**Tests Written**: Are tests created alongside or before implementation?"
      - "**Acceptance Criteria Met**: Does the implementation satisfy all acceptance criteria from spec?"
      - "**Code Quality**: Does the code meet the standards defined in the constitution?"
      - "**Progress Tracked**: Was progress communicated throughout implementation?"
      - "**All Tasks Complete**: Have all tasks in tasks.md been completed?"
